<%# %>
<%# Amazon Payments - Login and Pay for Spree Commerce %>
<%# %>
<%# @category    Amazon %>
<%# @package     Amazon_Payments %>
<%# @copyright   Copyright (c) 2014 Amazon.com %>
<%# @license     http://opensource.org/licenses/Apache-2.0  Apache License, Version 2.0 %>
<%# %>

<%
  gateway = Spree::Gateway::Amazon.for_currency(current_order(create_order_if_necessary: true).currency)
  return_path = '/amazonpay/create' unless local_assigns[:return_path]
%>

<%= javascript_include_tag gateway.widgets_url %>

<div id="AmazonPayButton"></div>

<script type="text/javascript" charset="utf-8">
  amazon.Pay.renderButton('#AmazonPayButton', {
    merchantId: "<%= gateway.preferred_merchant_id %>",
    createCheckoutSession: {
        url: "<%= return_path %>"
    },
    sandbox: gateway.preferred_test_mode,
    ledgerCurrency: gateway.preferred_currency,
    checkoutLanguage: 'en_US',
    productType: 'PayAndShip',
    placement: 'Cart'
  });
</script>
